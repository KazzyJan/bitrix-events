# Bitrix-user-events

## Test task on Bitrix (Тестовое задание Битрикс)
Задание было выполнено на виртуальной машине, в связи с чем я не смог проверить доставку писем адресату, т.к. не умею устанавливать и работать с smtp серверами.

## Задание
«Уведомление при добавлении пользователя в группу»:
− в системе уже создана группа «Контент-редакторы»;
− реализовать уведомление по email о том, что новый пользователь добавляется в группу «Контент-редакторы»;
− необходимо уведомлять и если создается новый пользователь, сразу с добавлением в группу, и если существующего пользователя добавили в группу;
− получатели письма – текущие пользователи группы «Контент-редакторы»;
− администратор должен иметь возможность отредактировать шаблон письма.

## Шаг первый
Я установил битрикс на виртуальную машину (VMBitrix7.5-3-centos7.9-vbox), скачанную с сайта битрикса. Также для своего удобства установил ngrok (это инструмент для создания общедоступных точек доступа (tunnels) к локальному серверу). С битриксом установился стандартный шаблон мебельной фабрики, т.к в шаблоне уже есть много функционала, и быстрее что то переделать, чем писать заного.

## Настройка сайта из меню администратора
Добавление типа события![image](https://github.com/KazzyJan/bitrix-events/assets/94743852/636ba56b-4010-48d6-9a56-2bf57d66d656)
Добавление почтового шаблона
![image](https://github.com/KazzyJan/bitrix-events/assets/94743852/ef48fe4d-c6fb-4e3c-8230-8f04e7be6059)
Настройки в главном модуле
![image](https://github.com/KazzyJan/bitrix-events/assets/94743852/fbda1483-9f5d-421a-acc9-2b6c161d0ca6)
Настройки SMTP (тут особо настроек нет,  так как нет smtp сервера, просто знаю, что тут также нужно настроить подключение)
![image](https://github.com/KazzyJan/bitrix-events/assets/94743852/412832f1-b9be-4272-ae89-c87137f36acf)


## PHP код
Для решения данной задачи я написал скрипт init.php с полным путём: www/local/php_interface/init.php, в котором написал класс обработчика событий EventHandlerResume. В нём есть функции для обработки необходимых событий. Подробнее код описан в комментариях в самом файле скрипта.

## Результаты
Так как я не могу отследить присланное на почту письмо, проверял работоспособность своего скрипта при помощи таблиц базы данных в админинке биитрикса.
Таблица b_event
![image](https://github.com/KazzyJan/bitrix-events/assets/94743852/1ee1c5d5-5f2e-415c-904d-33d5662cb938)
Таблица b_event_message
![image](https://github.com/KazzyJan/bitrix-events/assets/94743852/0537ae61-d881-4f43-b39a-249b4269bc31)
