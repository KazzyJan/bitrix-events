# Bitrix-user-events

## Test task on Bitrix (Тестовое задание Битрикс)
Задание было выполнено на виртуальной машине, в связи с чем я не смог проверить доставку писем адресату, т.к. не умею устанавливать и работать с smtp серверами.

## Задание
«Уведомление при добавлении пользователя в группу»:
− в системе уже создана группа «Контент-редакторы»;
− реализовать уведомление по email о том, что новый пользователь добавляется в группу «Контент-редакторы»;
− необходимо уведомлять и если создается новый пользователь, сразу с добавлением в группу, и если существующего пользователя добавили в группу;
− получатели письма – текущие пользователи группы «Контент-редакторы»;
− администратор должен иметь возможность отредактировать шаблон письма.

## Шаг первый
Я установил битрикс на витруальную машину (VMBitrix7.5-3-centos7.9-vbox), скаченную с сайта битрикса. Также для своего удобства установил ngrok (это инструмент для создания общедоступных точек доступа (tunnels) к локальному серверу). С битриксом установился стандартный шаблон мебельной фабрики, т.к в шаблоне уже есть много функционала, и быстрее что то переделать, чем писать заного.

## Настройка сайта из меню администратора
Добавление типа события
![image](https://github.com/KazzyJan/Bitrix-user-events/assets/94743852/989fce97-da5a-49fa-8bfb-7a0112f9b61b)
Добавление почтового шаблона
![image](https://github.com/KazzyJan/Bitrix-user-events/assets/94743852/3779e9f4-3b2b-4559-beb7-fc550e6f385e)
Настройки в главном модуле
![image](https://github.com/KazzyJan/Bitrix-user-events/assets/94743852/3043b4eb-d2f6-4a1a-822b-1111e66c9c06)
Настройки SMTP (тут особо натсроек нет,  так как нет smtp сервера, просто знаю, что тут также нужно настроить подключение)
![image](https://github.com/KazzyJan/Bitrix-user-events/assets/94743852/7f7a389b-4886-41d5-b595-17cb234bf2f6)


## PHP код
Для решения данной задачи я написал скрипт init.php с полным путём: www/local/php_interface/init.php, в котором написал класс обработчика событий EventHandlerResume. В нём есть функции для обработки необходимых событий. Подробнее код описан в комментариях в самом файле скрипта.

## Результаты
Так как я не могу отследить присланное на почту письмо, проверял работоспособность своего скрипта при помощи таблиц базы данных в админинке биитрикса.
Таблица b_event
![image](https://github.com/KazzyJan/Bitrix-user-events/assets/94743852/d9aa5b8b-66e5-44bf-8a41-b6048811674d)
Таблица b_event_message
![image](https://github.com/KazzyJan/Bitrix-user-events/assets/94743852/59e3da05-540d-4ab9-b1fb-6f01b7ebf95f)

